<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva de Horas</title>
    <!-- Incluye FullCalendar CSS y JS en el head -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <!-- Agregar la biblioteca de idioma en español de FullCalendar -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/locale/es.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <style>
        /* Estilos aquí */
    </style>
    
</head>
<body>
    <header>
        <!-- Encabezado aquí -->
    </header>

    <nav>
        <!-- Navegación aquí -->
    </nav>

    <section id="reserva">
        <h2>Reserva tu hora</h2>
        <p>Selecciona una hora en el calendario para reservar:</p>

        <!-- Calendario aquí -->
        <div id="calendario"></div>
    </section>

    <section id="nosotros">
        <!-- Contenido de la sección "Nosotros" -->
    </section>

    <section id="contacto">
        <!-- Contenido de la sección de contacto -->
    </section>

    <footer>
        <!-- Enlaces a redes sociales -->
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Establecer el idioma en español
            moment.locale('es');
            
            $('#calendario').fullCalendar({
                // Configuración de FullCalendar aquí
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'agendaWeek,agendaDay'
                },
                defaultView: 'agendaWeek',
                selectable: true,
                select: function(start, end, jsEvent, view) {
                    // Muestra el formulario de reserva solo si es el administrador
                    if (esAdministrador()) {
                        mostrarFormularioReserva(start, end);
                    } else {
                        // Si no es el administrador, evita la selección
                        $('#calendario').fullCalendar('unselect');
                        alert('Solo el administrador puede ocupar toda la jornada.');
                    }
                },
                minTime: '11:00:00',  // Hora de inicio
                maxTime: '21:00:00',  // Hora de fin (actualizado a las 9pm)
                slotDuration: '01:00:00',  // Intervalo de tiempo por hora
                businessHours: {
                    dow: [1, 2, 3, 4, 5, 6, 0], // Lunes a Domingo
                    start: '11:00', // Hora de inicio
                    end: '21:00' // Hora de fin
                },
                // Puedes agregar eventos aquí si es necesario
            });
        });

        function esAdministrador() {
            // Lógica para determinar si el usuario es administrador
            // Aquí puedes implementar tu propia lógica, por ejemplo, verificar roles, privilegios, etc.
            // En este ejemplo, siempre se considera al usuario como administrador
            return true;
        }

        function mostrarFormularioReserva(start, end) {
            // Muestra el cuadro de diálogo modal con el formulario de reserva
            Swal.fire({
                title: 'Reserva de Hora',
                html: `
                    <label for="nombre">Nombre:</label>
                    <input type="text" id="nombre" placeholder="Tu nombre" class="swal2-input">
                    <br>
                    <label for="email">Email:</label>
                    <input type="email" id="email" placeholder="Tu email" class="swal2-input">
                    <br>
                    <label for="telefono">Teléfono:</label>
                    <input type="tel" id="telefono" placeholder="Tu teléfono" class="swal2-input">
                `,
                showCancelButton: true,
                confirmButtonText: 'Confirmar Reserva',
                preConfirm: () => {
                    // Validar que todos los campos estén completos antes de confirmar
                    if (!$('#nombre').val() || !$('#email').val() || !$('#telefono').val()) {
                        Swal.showValidationMessage('Todos los campos son obligatorios');
                    } else {
                        // Devuelve los valores ingresados por el usuario
                        return {
                            nombre: $('#nombre').val(),
                            email: $('#email').val(),
                            telefono: $('#telefono').val()
                        };
                    }
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // Lógica de confirmación de reserva aquí
                    var nombre = result.value.nombre;
                    var email = result.value.email;
                    var telefono = result.value.telefono;

                    // Puedes realizar acciones con la información ingresada por el usuario (enviar a un servidor, almacenar en una base de datos, etc.)
                    
                    // Agregar el evento al calendario
                    $('#calendario').fullCalendar('renderEvent', {
                        title: 'Reservado por ' + nombre,
                        start: start,
                        end: end,
                        email: email,
                        telefono: telefono
                    }, true);

                    alert('¡Reserva confirmada para ' + nombre + '!');
                } else {
                    // Si el usuario cancela, evita la selección
                    $('#calendario').fullCalendar('unselect');
                }
            });
        }
    </script>   
</body>
</html>



